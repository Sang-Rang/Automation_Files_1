from payloads.pushdown.outliers.pl_pd_saph_outliers_num_key_nodate_nyse_archive_breaks import (
    PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET
)

PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_OUTLIERS = {
    "data": [
        {
            "id": 16493,
            "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-06-24T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey":
                "/wUiVAE3JlS4CQzS8FC0eVWxEyCLWkm6Vo9VpQoILxqp4QtYHUmRBeNcgjeRbeyl",
            "outColumn": "CLOSE",
            "outValue": "18.32",
            "obsSubType": "NUMERICAL",
            "outMedian": "10.44",
            "outCount": 1,
            "keyArr": [
                "RENN"
            ],
            "lb": 4.5269999999999975,
            "ub": 17.799000000000003,
            "confidence": 97,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 72129,
                "uuid": "82562652-f523-4f4e-9f81-312b4f4a7110"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 16495,
            "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-06-24T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey":
                "SWUD+SOTIYm/eYu7gbj2m2friIHr2Zk0Ra6pxfYRYdqdM538nhG2oqqhp/rvUNHY",
            "outColumn": "HIGH",
            "outValue": "1.79",
            "obsSubType": "NUMERICAL",
            "outMedian": "1.04",
            "outCount": 1,
            "keyArr": [
                "DDE"
            ],
            "lb": 0.5550000000000006,
            "ub": 1.762999999999999,
            "confidence": 98,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 72131,
                "uuid": "b87e87a4-88ff-4a2a-bdd0-2cd9542488f8"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 16494,
            "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-06-24T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey":
                "4z+GFXCWq691fw0g85YAvPtQhA6y7QN0kApRNCXOb89VsezF3Xpk0gnPkE0Rrmui",
            "outColumn": "LOW",
            "outValue": "15.58",
            "obsSubType": "NUMERICAL",
            "outMedian": "10.63",
            "outCount": 1,
            "keyArr": [
                "IDT"
            ],
            "lb": 6.9094999999999995,
            "ub": 15.309999999999999,
            "confidence": 98,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 72130,
                "uuid": "5f4d4f01-a7a6-4b86-ac18-cdd0a78c2a2f"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 16491,
            "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-06-24T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey":
                "Xb7Gc0LG/rCIBLRfIsKBBXMuqvpjpO5PgfPpraZcojXQJbZ0Xsn2zmERHc/Lj0mS",
            "outColumn": "OPEN",
            "outValue": "3.52",
            "obsSubType": "NUMERICAL",
            "outMedian": "2.01",
            "outCount": 1,
            "keyArr": [
                "LITB"
            ],
            "lb": 0.8652499999999996,
            "ub": 3.4472500000000004,
            "confidence": 98,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 72127,
                "uuid": "ced64da1-1a66-42b3-8d4b-72ee0a319896"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 16492,
            "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-06-24T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey":
                "d+YjjhgAake2xofEWKU1GhU3zeQJ+NI3hhKsCEm/tuM54SCVIN1n+dZNzg0SB5ub",
            "outColumn": "HIGH",
            "outValue": "2.83",
            "obsSubType": "NUMERICAL",
            "outMedian": "1.91",
            "outCount": 1,
            "keyArr": [
                "YGE"
            ],
            "lb": 1.0909999999999997,
            "ub": 2.7630000000000003,
            "confidence": 98,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 72128,
                "uuid": "c9d02de8-5ed3-4958-943f-52b8b8bc0bff"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 16490,
            "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-06-24T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey":
                "0kMqtNR6/FiSwdnxmegXeh5yYH2o7PCJOAH34PhVO3LimoTUFqJynySslFwNrv9O",
            "outColumn": "HIGH",
            "outValue": "3.52",
            "obsSubType": "NUMERICAL",
            "outMedian": "2.24",
            "outCount": 1,
            "keyArr": [
                "LITB"
            ],
            "lb": 1.0080000000000005,
            "ub": 3.5007999999999995,
            "confidence": 99,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 72126,
                "uuid": "ed60c136-64c0-4163-bee2-e1606e201ab9"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 16489,
            "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-06-24T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey":
                "OIci3RPpZzPpTgTi+aqbYzr/tfmrvR5fVVtIN+7OTVZH+KcD1W/8Wtb9EwRv50Bj",
            "outColumn": "LOW",
            "outValue": "83.5",
            "obsSubType": "NUMERICAL",
            "outMedian": "61.82",
            "outCount": 1,
            "keyArr": [
                "DST"
            ],
            "lb": 40.17975,
            "ub": 83.45025000000001,
            "confidence": 100,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 72125,
                "uuid": "11304fd1-bb41-48f9-bd7a-35fa8a347e1d"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 16487,
            "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-06-24T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey":
                "zVC+oFft+sfNwe+DyikDcOHHKudAAiP5KPYrszROWv75hPTLg8A7cFSJjMvoT876",
            "outColumn": "LOW",
            "outValue": "83.51",
            "obsSubType": "NUMERICAL",
            "outMedian": "61.82",
            "outCount": 2,
            "keyArr": [
                "DST"
            ],
            "lb": 40.17975,
            "ub": 83.45025000000001,
            "confidence": 100,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 72123,
                "uuid": "14903fb9-81fe-435d-8cea-d169b78f553b"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 16488,
            "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-06-24T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey":
                "tb7X3/YhjrTWXDKjZ1OQyb6VHK8ZDiNvAqcYPN2IJaYEOb1lTj43Vb0AaIO2e+6n",
            "outColumn": "LOW",
            "outValue": "83.52",
            "obsSubType": "NUMERICAL",
            "outMedian": "61.82",
            "outCount": 1,
            "keyArr": [
                "DST"
            ],
            "lb": 40.17975,
            "ub": 83.45025000000001,
            "confidence": 100,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 72124,
                "uuid": "bbfddd09-ec7e-4f55-b2ac-0b45f399f801"
            },
            "obsType": "OUTLIER_NUMERICAL"
        }
    ]
}

PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_DATA = [
    {
        "seqno": 2974062,
        "updts": "2023-08-04T20:11:31.030+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "LITB",
        "value_column": "OPEN",
        "value": "3.520000000000000000",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "2.0050000000000003",
        "lb": 0.8652499999999996,
        "ub": 3.4472500000000004,
        "confidence": 98,
        "cnt": 1,
        "link_id": "NYSE~|LITB~|2018-01-08",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974067,
        "updts": "2023-08-04T20:11:31.992+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "IDT",
        "value_column": "LOW",
        "value": "15.580000000000000000",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "10.63",
        "lb": 6.9094999999999995,
        "ub": 15.309999999999999,
        "confidence": 98,
        "cnt": 1,
        "link_id": "NYSE~|IDT~|2017-12-04",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974069,
        "updts": "2023-08-04T20:11:31.992+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.520000000000000000",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815000000000005",
        "lb": 40.17975,
        "ub": 83.45025000000001,
        "confidence": 100,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-16",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974070,
        "updts": "2023-08-04T20:11:31.992+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.510000000000000000",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815000000000005",
        "lb": 40.17975,
        "ub": 83.45025000000001,
        "confidence": 100,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-15",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974064,
        "updts": "2023-08-04T20:11:31.104+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "LITB",
        "value_column": "HIGH",
        "value": "3.520000000000000000",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "2.24",
        "lb": 1.0080000000000005,
        "ub": 3.5007999999999995,
        "confidence": 99,
        "cnt": 1,
        "link_id": "NYSE~|LITB~|2018-01-08",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974063,
        "updts": "2023-08-04T20:11:31.104+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "YGE",
        "value_column": "HIGH",
        "value": "2.830000000000000000",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "1.9100000000000001",
        "lb": 1.0909999999999997,
        "ub": 2.7630000000000003,
        "confidence": 98,
        "cnt": 1,
        "link_id": "NYSE~|YGE~|2018-01-05",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974065,
        "updts": "2023-08-04T20:11:31.104+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "DDE",
        "value_column": "HIGH",
        "value": "1.790000000000000000",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "1.04",
        "lb": 0.5550000000000006,
        "ub": 1.762999999999999,
        "confidence": 98,
        "cnt": 1,
        "link_id": "NYSE~|DDE~|2018-01-12",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974068,
        "updts": "2023-08-04T20:11:31.992+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.500000000000000000",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815000000000005",
        "lb": 40.17975,
        "ub": 83.45025000000001,
        "confidence": 100,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-11",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974071,
        "updts": "2023-08-04T20:11:31.992+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.510000000000000000",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815000000000005",
        "lb": 40.17975,
        "ub": 83.45025000000001,
        "confidence": 100,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-12",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974073,
        "updts": "2023-08-04T20:11:32.344+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "RENN",
        "value_column": "CLOSE",
        "value": "18.320000000000000000",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "10.440000000000001",
        "lb": 4.5269999999999975,
        "ub": 17.799000000000003,
        "confidence": 97,
        "cnt": 1,
        "link_id": "NYSE~|RENN~|2018-01-03",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    }
]

PD_SAPH_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_QUERY_RESULT = [
    {
        "id": 3165,
        "value_column": "CLOSE",
        "EXCH": "NYSE",
        "SYMBOL": "RENN",
        "TRADE_DATE": "2018-01-03",
        "OPEN": 13.39,
        "HIGH": 18.7,
        "LOW": 13.39,
        "CLOSE": 18.32,
        "VOLUME": 10462000,
        "PART_DATE_STR": "2018-01-03"
    },
    {
        "id": 3165,
        "value_column": "HIGH",
        "EXCH": "NYSE",
        "SYMBOL": "YGE",
        "TRADE_DATE": "2018-01-05",
        "OPEN": 1.7,
        "HIGH": 2.83,
        "LOW": 1.682,
        "CLOSE": 2.115,
        "VOLUME": 6047400,
        "PART_DATE_STR": "2018-01-05"
    },
    {
        "id": 3165,
        "value_column": "OPEN",
        "EXCH": "NYSE",
        "SYMBOL": "LITB",
        "TRADE_DATE": "2018-01-08",
        "OPEN": 3.52,
        "HIGH": 3.52,
        "LOW": 2.695,
        "CLOSE": 2.81,
        "VOLUME": 4890200,
        "PART_DATE_STR": "2018-01-08"
    },
    {
        "id": 3165,
        "value_column": "HIGH",
        "EXCH": "NYSE",
        "SYMBOL": "LITB",
        "TRADE_DATE": "2018-01-08",
        "OPEN": 3.52,
        "HIGH": 3.52,
        "LOW": 2.695,
        "CLOSE": 2.81,
        "VOLUME": 4890200,
        "PART_DATE_STR": "2018-01-08"
    },
    {
        "id": 3165,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-11",
        "OPEN": 84.14,
        "HIGH": 84.48,
        "LOW": 83.5,
        "CLOSE": 83.92,
        "VOLUME": 10154600,
        "PART_DATE_STR": "2018-01-11"
    },
    {
        "id": 3165,
        "value_column": "HIGH",
        "EXCH": "NYSE",
        "SYMBOL": "DDE",
        "TRADE_DATE": "2018-01-12",
        "OPEN": 1.0,
        "HIGH": 1.79,
        "LOW": 1.0,
        "CLOSE": 1.11,
        "VOLUME": 2476400,
        "PART_DATE_STR": "2018-01-12"
    },
    {
        "id": 3165,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-12",
        "OPEN": 83.95,
        "HIGH": 84.03,
        "LOW": 83.51,
        "CLOSE": 83.51,
        "VOLUME": 3083400,
        "PART_DATE_STR": "2018-01-12"
    },
    {
        "id": 3165,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-15",
        "OPEN": 83.51,
        "HIGH": 83.51,
        "LOW": 83.51,
        "CLOSE": 83.51,
        "VOLUME": 0,
        "PART_DATE_STR": "2018-01-15"
    },
    {
        "id": 3165,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-16",
        "OPEN": 83.55,
        "HIGH": 83.75,
        "LOW": 83.52,
        "CLOSE": 83.63,
        "VOLUME": 2238800,
        "PART_DATE_STR": "2018-01-16"
    },
    {
        "id": 3165,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "IDT",
        "TRADE_DATE": "2017-12-04",
        "OPEN": 16.08,
        "HIGH": 16.48,
        "LOW": 15.58,
        "CLOSE": 15.63,
        "VOLUME": 175500,
        "PART_DATE_STR": "2017-12-04"
    }
]
