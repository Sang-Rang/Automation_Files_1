from payloads.pushdown.outliers.pl_pd_bq_outliers_num_key_nodate_nyse_archive_breaks import (
    PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET
)

PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_OUTLIERS = {
    "data": [
        {
            "id": 515513,
            "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2025-01-19T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "O9bXfbAzGAHi8o5DpMxpYoorC1dNK0sHEn/2Bq6pzmLDhw+VLsNaaYtK5AX2uO+Z",
            "outColumn": "CLOSE",
            "outValue": "18.32",
            "obsSubType": "NUMERICAL",
            "outMedian": "10.44",
            "outCount": 1,
            "keyArr": [
                "RENN"
            ],
            "lb": 4.527,
            "ub": 17.799,
            "confidence": 97,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1698868,
                "uuid": "84c9d7f6-2dfe-42c4-b24a-299b6f076d9e"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 515518,
            "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2025-01-19T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "C4WGs9eaqYi3lJ03TgmWBRQZP4hCIdGE0ghGWqPdF/A4Q7FENd8Ch+URSsn+t4og",
            "outColumn": "HIGH",
            "outValue": "1.79",
            "obsSubType": "NUMERICAL",
            "outMedian": "1.04",
            "outCount": 1,
            "keyArr": [
                "DDE"
            ],
            "lb": 0.555,
            "ub": 1.763,
            "confidence": 98,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1698873,
                "uuid": "65086a43-9d47-49f4-a951-9ad84601a5a4"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 515517,
            "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2025-01-19T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "aj5im8Cmr4Qrsa9c5BSTp5aUH15e+m/CCpeWY1OuAtYYFXuJLCEgXQ2X/btYvLaV",
            "outColumn": "LOW",
            "outValue": "15.58",
            "obsSubType": "NUMERICAL",
            "outMedian": "10.63",
            "outCount": 1,
            "keyArr": [
                "IDT"
            ],
            "lb": 6.9095,
            "ub": 15.31,
            "confidence": 98,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1698872,
                "uuid": "7ecafd19-fa8f-4ba1-ae52-56820b888f74"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 515521,
            "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2025-01-19T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "VQmWh/Po/fKZsRzFgZJwLIJJoSctlvSnuWnyqOs/sygLvz0c31mu9u9I6DLUocuQ",
            "outColumn": "OPEN",
            "outValue": "3.52",
            "obsSubType": "NUMERICAL",
            "outMedian": "2.01",
            "outCount": 1,
            "keyArr": [
                "LITB"
            ],
            "lb": 0.86525,
            "ub": 3.44725,
            "confidence": 98,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1698876,
                "uuid": "67be7687-b63e-47e9-b789-5b400446ba56"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 515520,
            "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2025-01-19T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "nrMcDURyJs1a8EaIfI2CRSkbV80YeO1gKUSxmQpFlIMhWAF6eVmQdOi8vtEmqbla",
            "outColumn": "HIGH",
            "outValue": "2.83",
            "obsSubType": "NUMERICAL",
            "outMedian": "1.91",
            "outCount": 1,
            "keyArr": [
                "YGE"
            ],
            "lb": 1.091,
            "ub": 2.763,
            "confidence": 98,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1698875,
                "uuid": "a0a8b934-1a4f-465c-a1b6-4f65f2949c9e"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 515519,
            "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2025-01-19T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "TFyC/t7EPI7awwJxkZOqOS2rYGzKjPMmdgPMmpAl/g48QzhWehPR2o8KFEMngycO",
            "outColumn": "HIGH",
            "outValue": "3.52",
            "obsSubType": "NUMERICAL",
            "outMedian": "2.24",
            "outCount": 1,
            "keyArr": [
                "LITB"
            ],
            "lb": 1.008,
            "ub": 3.5008,
            "confidence": 99,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1698874,
                "uuid": "645d28ba-ef7e-41ac-a343-f450e6433aa7"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 515514,
            "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2025-01-19T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "5Rq1QAb7QxdHbpRhz7nyK+79HI9nfp7IiNSFQTUe1opKGjf8cxUUejokNmcPh4un",
            "outColumn": "LOW",
            "outValue": "83.5",
            "obsSubType": "NUMERICAL",
            "outMedian": "61.82",
            "outCount": 1,
            "keyArr": [
                "DST"
            ],
            "lb": 40.17975,
            "ub": 83.45025,
            "confidence": 100,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1698869,
                "uuid": "9d95a07d-35c5-414d-8d4c-2b4975434387"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 515515,
            "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2025-01-19T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "9BQ8sv0KdSo/GsuO+HbHVzc5jkeL2HaMqvYgLG8ZxRdQlmgcdjpEkj50IblIJcRc",
            "outColumn": "LOW",
            "outValue": "83.51",
            "obsSubType": "NUMERICAL",
            "outMedian": "61.82",
            "outCount": 2,
            "keyArr": [
                "DST"
            ],
            "lb": 40.17975,
            "ub": 83.45025,
            "confidence": 100,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1698870,
                "uuid": "5a37653e-7571-43ad-afa6-d1d7eb2c14b5"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 515516,
            "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2025-01-19T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "LvBh70vbZh/kWVDjxyPDeGmvlQ5DqGiA4sWITy8XSR4yK5OdAHxBDEqwSvSB8oyq",
            "outColumn": "LOW",
            "outValue": "83.52",
            "obsSubType": "NUMERICAL",
            "outMedian": "61.82",
            "outCount": 1,
            "keyArr": [
                "DST"
            ],
            "lb": 40.17975,
            "ub": 83.45025,
            "confidence": 100,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1698871,
                "uuid": "4d36af10-00a3-4d9e-a0f2-1d6cc22f1814"
            },
            "obsType": "OUTLIER_NUMERICAL"
        }
    ]
}

PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_DATA = [
    {
        "seqno": 2974062,
        "updts": "2023-08-04T20:11:31.030+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "LITB",
        "value_column": "OPEN",
        "value": "3.52",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "2.005",
        "lb": 0.86525,
        "ub": 3.44725,
        "confidence": 98,
        "cnt": 1,
        "link_id": "NYSE~|LITB~|2018-01-08",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974067,
        "updts": "2023-08-04T20:11:31.992+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "IDT",
        "value_column": "LOW",
        "value": "15.58",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "10.63",
        "lb": 6.9095,
        "ub": 15.31,
        "confidence": 98,
        "cnt": 1,
        "link_id": "NYSE~|IDT~|2017-12-04",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974069,
        "updts": "2023-08-04T20:11:31.992+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.52",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815",
        "lb": 40.17975,
        "ub": 83.45025,
        "confidence": 100,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-16",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974070,
        "updts": "2023-08-04T20:11:31.992+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.51",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815",
        "lb": 40.17975,
        "ub": 83.45025,
        "confidence": 100,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-15",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974064,
        "updts": "2023-08-04T20:11:31.104+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "LITB",
        "value_column": "HIGH",
        "value": "3.52",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "2.24",
        "lb": 1.008,
        "ub": 3.5008,
        "confidence": 99,
        "cnt": 1,
        "link_id": "NYSE~|LITB~|2018-01-08",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974063,
        "updts": "2023-08-04T20:11:31.104+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "YGE",
        "value_column": "HIGH",
        "value": "2.83",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "1.91",
        "lb": 1.091,
        "ub": 2.763,
        "confidence": 98,
        "cnt": 1,
        "link_id": "NYSE~|YGE~|2018-01-05",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974065,
        "updts": "2023-08-04T20:11:31.104+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "DDE",
        "value_column": "HIGH",
        "value": "1.79",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "1.04",
        "lb": 0.555,
        "ub": 1.763,
        "confidence": 98,
        "cnt": 1,
        "link_id": "NYSE~|DDE~|2018-01-12",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974068,
        "updts": "2023-08-04T20:11:31.992+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.5",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815",
        "lb": 40.17975,
        "ub": 83.45025,
        "confidence": 100,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-11",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974071,
        "updts": "2023-08-04T20:11:31.992+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.51",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815",
        "lb": 40.17975,
        "ub": 83.45025,
        "confidence": 100,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-12",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": 2974073,
        "updts": "2023-08-04T20:11:32.344+0000",
        "job_uuid": "e34702ee-9e16-41a8-aa5f-8d7b89ec1ef4",
        "dataset": PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-08-04T00:00:00.000+0000",
        "id": 2835,
        "key_column": "SYMBOL",
        "key_value": "RENN",
        "value_column": "CLOSE",
        "value": "18.32",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "10.44",
        "lb": 4.527,
        "ub": 17.799,
        "confidence": 97,
        "cnt": 1,
        "link_id": "NYSE~|RENN~|2018-01-03",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    }
]

PD_BQ_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_QUERY_RESULT = [
    {
        "id": 3165,
        "value_column": "CLOSE",
        "EXCH": "NYSE",
        "SYMBOL": "RENN",
        "TRADE_DATE": "2018-01-03",
        "OPEN": 13.39,
        "HIGH": 18.7,
        "LOW": 13.39,
        "CLOSE": 18.32,
        "VOLUME": 10462000,
        "PART_DATE_STR": "2018-01-03"
    },
    {
        "id": 3165,
        "value_column": "HIGH",
        "EXCH": "NYSE",
        "SYMBOL": "YGE",
        "TRADE_DATE": "2018-01-05",
        "OPEN": 1.7,
        "HIGH": 2.83,
        "LOW": 1.682,
        "CLOSE": 2.115,
        "VOLUME": 6047400,
        "PART_DATE_STR": "2018-01-05"
    },
    {
        "id": 3165,
        "value_column": "OPEN",
        "EXCH": "NYSE",
        "SYMBOL": "LITB",
        "TRADE_DATE": "2018-01-08",
        "OPEN": 3.52,
        "HIGH": 3.52,
        "LOW": 2.695,
        "CLOSE": 2.81,
        "VOLUME": 4890200,
        "PART_DATE_STR": "2018-01-08"
    },
    {
        "id": 3165,
        "value_column": "HIGH",
        "EXCH": "NYSE",
        "SYMBOL": "LITB",
        "TRADE_DATE": "2018-01-08",
        "OPEN": 3.52,
        "HIGH": 3.52,
        "LOW": 2.695,
        "CLOSE": 2.81,
        "VOLUME": 4890200,
        "PART_DATE_STR": "2018-01-08"
    },
    {
        "id": 3165,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-11",
        "OPEN": 84.14,
        "HIGH": 84.48,
        "LOW": 83.5,
        "CLOSE": 83.92,
        "VOLUME": 10154600,
        "PART_DATE_STR": "2018-01-11"
    },
    {
        "id": 3165,
        "value_column": "HIGH",
        "EXCH": "NYSE",
        "SYMBOL": "DDE",
        "TRADE_DATE": "2018-01-12",
        "OPEN": 1.0,
        "HIGH": 1.79,
        "LOW": 1.0,
        "CLOSE": 1.11,
        "VOLUME": 2476400,
        "PART_DATE_STR": "2018-01-12"
    },
    {
        "id": 3165,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-12",
        "OPEN": 83.95,
        "HIGH": 84.03,
        "LOW": 83.51,
        "CLOSE": 83.51,
        "VOLUME": 3083400,
        "PART_DATE_STR": "2018-01-12"
    },
    {
        "id": 3165,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-15",
        "OPEN": 83.51,
        "HIGH": 83.51,
        "LOW": 83.51,
        "CLOSE": 83.51,
        "VOLUME": 0,
        "PART_DATE_STR": "2018-01-15"
    },
    {
        "id": 3165,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-16",
        "OPEN": 83.55,
        "HIGH": 83.75,
        "LOW": 83.52,
        "CLOSE": 83.63,
        "VOLUME": 2238800,
        "PART_DATE_STR": "2018-01-16"
    },
    {
        "id": 3165,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "IDT",
        "TRADE_DATE": "2017-12-04",
        "OPEN": 16.08,
        "HIGH": 16.48,
        "LOW": 15.58,
        "CLOSE": 15.63,
        "VOLUME": 175500,
        "PART_DATE_STR": "2017-12-04"
    }
]
