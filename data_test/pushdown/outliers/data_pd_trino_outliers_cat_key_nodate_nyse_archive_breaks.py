from payloads.pushdown.outliers.pl_pd_trino_outliers_cat_key_nodate_nyse_archive_breaks import (
    PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
)

PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_OUTLIERS = {
    "data": [
        {
            "id": 492575,
            "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2024-09-22T00:00:00.000+0000",
            "outKeyColumn": "exch",
            "outKey": "UzTOQkLZ/G/ZgkL7zkFyK2LV59P7qLEqZpYBnCjoqiOVdlcWSLVvAdeqrD+DY2+f",
            "outColumn": "symbol",
            "outValue": "LBRT",
            "obsSubType": "CATEGORICAL",
            "outMedian": "INVALID",
            "outCount": 2,
            "keyArr": [
                "NYSE"
            ],
            "lb": 0.0,
            "ub": 0.0,
            "confidence": 0,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1527200,
                "uuid": "7c504563-ceed-4da4-af0c-5a1099191da7"
            },
            "obsType": "OUTLIER_CATEGORICAL"
        },
        {
            "id": 492576,
            "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2024-09-22T00:00:00.000+0000",
            "outKeyColumn": "exch",
            "outKey": "G9TN51eyGFVKOyTmHENkHxUyD7OfAKNjTWJL05np7DtrZQRpxIcodcT28Jf942xP",
            "outColumn": "symbol",
            "outValue": "SRE-A",
            "obsSubType": "CATEGORICAL",
            "outMedian": "INVALID",
            "outCount": 3,
            "keyArr": [
                "NYSE"
            ],
            "lb": 0.0,
            "ub": 0.0,
            "confidence": 0,
            "owlRank": 0,
            "linkId": "",
            "linkIdArr": [
                ""
            ],
            "assignmentId": {
                "id": 1527201,
                "uuid": "b334c0ff-6428-4652-ac40-8bf8afce4e9a"
            },
            "obsType": "OUTLIER_CATEGORICAL"
        }
    ]
}

PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_DATA = [
  {
    "seqno": 10862688,
    "updts": "2024-10-02T09:38:22.606+0000",
    "job_uuid": "5c3b11c9-8973-41b3-88d1-9ebe93fb1993",
    "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
    "run_id": "2024-10-02T00:00:00.000+0000",
    "id": 2080,
    "key_column": "exch",
    "key_value": "NYSE",
    "value_column": "symbol",
    "value": "LBRT",
    "date_value": None,
    "type": "CATEGORICAL",
    "median": "INVALID",
    "lb": None,
    "ub": None,
    "confidence": 0,
    "cnt": 1,
    "link_id": "NYSE~|LBRT~|2018-01-12",
    "is_outlier": True,
    "is_historical": False,
    "is_topn": False,
    "is_botn": True,
    "source_date": None,
    "frequency": 2,
    "percentile": 0
  },
  {
    "seqno": 10862689,
    "updts": "2024-10-02T09:38:22.606+0000",
    "job_uuid": "5c3b11c9-8973-41b3-88d1-9ebe93fb1993",
    "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
    "run_id": "2024-10-02T00:00:00.000+0000",
    "id": 2080,
    "key_column": "exch",
    "key_value": "NYSE",
    "value_column": "symbol",
    "value": "SRE-A",
    "date_value": None,
    "type": "CATEGORICAL",
    "median": "INVALID",
    "lb": None,
    "ub": None,
    "confidence": 0,
    "cnt": 1,
    "link_id": "NYSE~|SRE-A~|2018-01-16",
    "is_outlier": True,
    "is_historical": False,
    "is_topn": False,
    "is_botn": True,
    "source_date": None,
    "frequency": 3,
    "percentile": 0.000318877551
  },
  {
    "seqno": 10862690,
    "updts": "2024-10-02T09:38:22.606+0000",
    "job_uuid": "5c3b11c9-8973-41b3-88d1-9ebe93fb1993",
    "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
    "run_id": "2024-10-02T00:00:00.000+0000",
    "id": 2080,
    "key_column": "exch",
    "key_value": "NYSE",
    "value_column": "symbol",
    "value": "LBRT",
    "date_value": None,
    "type": "CATEGORICAL",
    "median": "INVALID",
    "lb": None,
    "ub": None,
    "confidence": 0,
    "cnt": 1,
    "link_id": "NYSE~|LBRT~|2018-01-16",
    "is_outlier": True,
    "is_historical": False,
    "is_topn": False,
    "is_botn": True,
    "source_date": None,
    "frequency": 2,
    "percentile": 0
  },
  {
    "seqno": 10862691,
    "updts": "2024-10-02T09:38:22.606+0000",
    "job_uuid": "5c3b11c9-8973-41b3-88d1-9ebe93fb1993",
    "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
    "run_id": "2024-10-02T00:00:00.000+0000",
    "id": 2080,
    "key_column": "exch",
    "key_value": "NYSE",
    "value_column": "symbol",
    "value": "SRE-A",
    "date_value": None,
    "type": "CATEGORICAL",
    "median": "INVALID",
    "lb": None,
    "ub": None,
    "confidence": 0,
    "cnt": 1,
    "link_id": "NYSE~|SRE-A~|2018-01-12",
    "is_outlier": True,
    "is_historical": False,
    "is_topn": False,
    "is_botn": True,
    "source_date": None,
    "frequency": 3,
    "percentile": 0.000318877551
  },
  {
    "seqno": 10862692,
    "updts": "2024-10-02T09:38:22.606+0000",
    "job_uuid": "5c3b11c9-8973-41b3-88d1-9ebe93fb1993",
    "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
    "run_id": "2024-10-02T00:00:00.000+0000",
    "id": 2080,
    "key_column": "exch",
    "key_value": "NYSE",
    "value_column": "symbol",
    "value": "SRE-A",
    "date_value": None,
    "type": "CATEGORICAL",
    "median": "INVALID",
    "lb": None,
    "ub": None,
    "confidence": 0,
    "cnt": 1,
    "link_id": "NYSE~|SRE-A~|2018-01-15",
    "is_outlier": True,
    "is_historical": False,
    "is_topn": False,
    "is_botn": True,
    "source_date": None,
    "frequency": 3,
    "percentile": 0.000318877551
  },
  {
    "seqno": 10862684,
    "updts": "2024-10-02T09:38:22.606+0000",
    "job_uuid": "5c3b11c9-8973-41b3-88d1-9ebe93fb1993",
    "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
    "run_id": "2024-10-02T00:00:00.000+0000",
    "id": 2080,
    "key_column": "exch",
    "key_value": "NYSE",
    "value_column": "symbol",
    "value": "ZX",
    "date_value": None,
    "type": "CATEGORICAL",
    "median": "INVALID",
    "lb": None,
    "ub": None,
    "confidence": 0,
    "cnt": 33,
    "link_id": "",
    "is_outlier": True,
    "is_historical": False,
    "is_topn": True,
    "is_botn": False,
    "source_date": None,
    "frequency": 33,
    "percentile": 0.02168367347
  },
  {
    "seqno": 10862685,
    "updts": "2024-10-02T09:38:22.606+0000",
    "job_uuid": "5c3b11c9-8973-41b3-88d1-9ebe93fb1993",
    "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
    "run_id": "2024-10-02T00:00:00.000+0000",
    "id": 2080,
    "key_column": "exch",
    "key_value": "NYSE",
    "value_column": "symbol",
    "value": "ZYME",
    "date_value": None,
    "type": "CATEGORICAL",
    "median": "INVALID",
    "lb": None,
    "ub": None,
    "confidence": 0,
    "cnt": 33,
    "link_id": "",
    "is_outlier": True,
    "is_historical": False,
    "is_topn": True,
    "is_botn": False,
    "source_date": None,
    "frequency": 33,
    "percentile": 0.02168367347
  },
  {
    "seqno": 10862686,
    "updts": "2024-10-02T09:38:22.606+0000",
    "job_uuid": "5c3b11c9-8973-41b3-88d1-9ebe93fb1993",
    "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
    "run_id": "2024-10-02T00:00:00.000+0000",
    "id": 2080,
    "key_column": "exch",
    "key_value": "NYSE",
    "value_column": "symbol",
    "value": "AAN",
    "date_value": None,
    "type": "CATEGORICAL",
    "median": "INVALID",
    "lb": None,
    "ub": None,
    "confidence": 0,
    "cnt": 33,
    "link_id": "",
    "is_outlier": False,
    "is_historical": False,
    "is_topn": True,
    "is_botn": False,
    "source_date": None,
    "frequency": 34,
    "percentile": 1
  },
  {
    "seqno": 10862687,
    "updts": "2024-10-02T09:38:22.606+0000",
    "job_uuid": "5c3b11c9-8973-41b3-88d1-9ebe93fb1993",
    "dataset": PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
    "run_id": "2024-10-02T00:00:00.000+0000",
    "id": 2080,
    "key_column": "exch",
    "key_value": "NASDAQ",
    "value_column": "symbol",
    "value": "AAN",
    "date_value": None,
    "type": "CATEGORICAL",
    "median": "INVALID",
    "lb": None,
    "ub": None,
    "confidence": 100,
    "cnt": 1,
    "link_id": "",
    "is_outlier": False,
    "is_historical": False,
    "is_topn": True,
    "is_botn": True,
    "source_date": None,
    "frequency": 1,
    "percentile": 0
  }
]

PD_TRINO_OUTLIERS_CAT_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_QUERY_RESULT = [
    {
        "id": 2080,
        "value_column": "symbol",
        "exch": "NYSE",
        "symbol": "LBRT",
        "trade_date": "2018-01-12",
        "open": 21.2,
        "high": 22.12,
        "low": 21.05,
        "close": 21.75,
        "volume": 10448600,
        "part_date_str": "2018-01-12"
    },
    {
        "id": 2080,
        "value_column": "symbol",
        "exch": "NYSE",
        "symbol": "SRE-A",
        "trade_date": "2018-01-16",
        "open": 100.3,
        "high": 100.62,
        "low": 100.01,
        "close": 100.44,
        "volume": 467600,
        "part_date_str": "2018-01-16"
    },
    {
        "id": 2080,
        "value_column": "symbol",
        "exch": "NYSE",
        "symbol": "LBRT",
        "trade_date": "2018-01-16",
        "open": 21.9,
        "high": 22.09,
        "low": 21.36,
        "close": 21.82,
        "volume": 1044100,
        "part_date_str": "2018-01-16"
    },
    {
        "id": 2080,
        "value_column": "symbol",
        "exch": "NYSE",
        "symbol": "SRE-A",
        "trade_date": "2018-01-12",
        "open": 99.96,
        "high": 100.62,
        "low": 99.96,
        "close": 100.28,
        "volume": 543300,
        "part_date_str": "2018-01-12"
    },
    {
        "id": 2080,
        "value_column": "symbol",
        "exch": "NYSE",
        "symbol": "SRE-A",
        "trade_date": "2018-01-15",
        "open": 100.28,
        "high": 100.28,
        "low": 100.28,
        "close": 100.28,
        "volume": 0,
        "part_date_str": "2018-01-15"
    }
]
