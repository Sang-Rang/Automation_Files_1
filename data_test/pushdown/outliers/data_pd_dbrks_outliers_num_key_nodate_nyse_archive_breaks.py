from payloads.pushdown.outliers.pl_pd_dbrks_outliers_num_key_nodate_nyse_archive_breaks import (
    PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
)

PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_OUTLIERS = {
    "data": [
        {
            "id": 9960,
            "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-09-13T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "Kp5GHbmGKaQIgq2IEKVi568ueAy0f2i7ibtJ30nE8tnixL991DGhGTUjEiPWZMWi",
            "outColumn": "OPEN",
            "outValue": "3.52",
            "obsSubType": "NUMERICAL",
            "outMedian": "2.01",
            "outCount": 1,
            "keyArr": [
                "LITB"
            ],
            "lb": 0.8652499999999996,
            "ub": 3.4472500000000004,
            "confidence": 97,
            "owlRank": 0,
            "linkId": "NYSE~|LITB~|2018-01-08",
            "linkIdArr": [
                "2018-01-08",
                "LITB",
                "NYSE"
            ],
            "assignmentId": {
                "id": 29877,
                "uuid": "780bae22-3ac4-4f0e-b0fe-8f1e31c458dc"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 9962,
            "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-09-13T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "3/GAevbG41DUyfAJKJMPe/H8lT4BsXFg6wrceJ92wsbKj9J/HIv63H3AZW0vKC12",
            "outColumn": "CLOSE",
            "outValue": "18.32",
            "obsSubType": "NUMERICAL",
            "outMedian": "10.44",
            "outCount": 1,
            "keyArr": [
                "RENN"
            ],
            "lb": 4.526999999999995,
            "ub": 17.799000000000007,
            "confidence": 97,
            "owlRank": 0,
            "linkId": "NYSE~|RENN~|2018-01-03",
            "linkIdArr": [
                "RENN",
                "NYSE",
                "2018-01-03"
            ],
            "assignmentId": {
                "id": 29879,
                "uuid": "5dc8cbb7-6692-4816-8759-c35e14962917"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 9961,
            "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-09-13T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "PeFKSEl/qKvGtwbQWrl7tOQUZLR979lWDMjIPwVl61XtfMxzUJWVKh7SmTC4sn1h",
            "outColumn": "HIGH",
            "outValue": "2.83",
            "obsSubType": "NUMERICAL",
            "outMedian": "1.91",
            "outCount": 1,
            "keyArr": [
                "YGE"
            ],
            "lb": 1.0909999999999997,
            "ub": 2.7630000000000003,
            "confidence": 97,
            "owlRank": 0,
            "linkId": "NYSE~|YGE~|2018-01-05",
            "linkIdArr": [
                "2018-01-05",
                "YGE",
                "NYSE"
            ],
            "assignmentId": {
                "id": 29878,
                "uuid": "a74d59a6-e09b-46c7-93b1-abd3d5850584"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 9964,
            "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-09-13T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "OlUrkeq/XqG0RU1Dxg+T/lXRoTUtwgWUp1CXzUYahd2Kv/sXpGZhDSCQ1L9q0orE",
            "outColumn": "HIGH",
            "outValue": "1.79",
            "obsSubType": "NUMERICAL",
            "outMedian": "1.04",
            "outCount": 1,
            "keyArr": [
                "DDE"
            ],
            "lb": 0.5549999999999999,
            "ub": 1.7630000000000001,
            "confidence": 98,
            "owlRank": 0,
            "linkId": "NYSE~|DDE~|2018-01-12",
            "linkIdArr": [
                "DDE",
                "NYSE",
                "2018-01-12"
            ],
            "assignmentId": {
                "id": 29881,
                "uuid": "138c6b24-c1b5-411d-8a66-638a5aa3ae26"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 9963,
            "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-09-13T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "CDHEbfebsX9Xbo3x7BEnG04Clb5EBTld8spdO4ikmo8N9X+W76bPqKNOeawc2V2q",
            "outColumn": "LOW",
            "outValue": "15.58",
            "obsSubType": "NUMERICAL",
            "outMedian": "10.63",
            "outCount": 1,
            "keyArr": [
                "IDT"
            ],
            "lb": 6.9094999999999995,
            "ub": 15.309999999999999,
            "confidence": 98,
            "owlRank": 0,
            "linkId": "NYSE~|IDT~|2017-12-04",
            "linkIdArr": [
                "2017-12-04",
                "IDT",
                "NYSE"
            ],
            "assignmentId": {
                "id": 29880,
                "uuid": "ea4a188d-9f39-4942-b1fa-b9563b26455d"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 9958,
            "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-09-13T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "R71y2LOIrVJosTcn+9OaIV2V3bc1feVtHwK06xLFDgMJcFgH2DBYmy6IPYuvIeOj",
            "outColumn": "LOW",
            "outValue": "83.5",
            "obsSubType": "NUMERICAL",
            "outMedian": "61.82",
            "outCount": 1,
            "keyArr": [
                "DST"
            ],
            "lb": 40.17974999999999,
            "ub": 83.45025000000001,
            "confidence": 99,
            "owlRank": 0,
            "linkId": "NYSE~|DST~|2018-01-11",
            "linkIdArr": [
                "DST",
                "NYSE",
                "2018-01-11"
            ],
            "assignmentId": {
                "id": 29875,
                "uuid": "86b5a047-7c7f-498f-a7ad-46d5c3256505"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 9956,
            "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-09-13T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "PNlac5wlHV4J2wQ5ZzjFUVSubF03I5fu8voJlK1JxQbqEi+jt4aJEQixCJca20LU",
            "outColumn": "LOW",
            "outValue": "83.51",
            "obsSubType": "NUMERICAL",
            "outMedian": "61.82",
            "outCount": 2,
            "keyArr": [
                "DST"
            ],
            "lb": 40.17974999999999,
            "ub": 83.45025000000001,
            "confidence": 99,
            "owlRank": 0,
            "linkId": "NYSE~|DST~|2018-01-15",
            "linkIdArr": [
                "2018-01-15",
                "DST",
                "NYSE"
            ],
            "assignmentId": {
                "id": 29873,
                "uuid": "b49be535-2c07-4ac8-b13a-3ae713aea474"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 9957,
            "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-09-13T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "sX6EpLjs5BYMIF30SlndBYIQ6nB47x6cJr5ZJ3yELD7ehk2UQPT3xbETYcPNwnXX",
            "outColumn": "LOW",
            "outValue": "83.52",
            "obsSubType": "NUMERICAL",
            "outMedian": "61.82",
            "outCount": 1,
            "keyArr": [
                "DST"
            ],
            "lb": 40.17974999999999,
            "ub": 83.45025000000001,
            "confidence": 99,
            "owlRank": 0,
            "linkId": "NYSE~|DST~|2018-01-16",
            "linkIdArr": [
                "2018-01-16",
                "DST",
                "NYSE"
            ],
            "assignmentId": {
                "id": 29874,
                "uuid": "5a89953f-fa95-46e5-894d-458122542c74"
            },
            "obsType": "OUTLIER_NUMERICAL"
        },
        {
            "id": 9959,
            "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
            "runId": "2023-09-13T00:00:00.000+0000",
            "outKeyColumn": "SYMBOL",
            "outKey": "EDMXvzkFys4dw+EfBe3fA4rk6GDFl+aEEAVvh+btWZX6qaZtxOXFkauCi4LJcs2P",
            "outColumn": "HIGH",
            "outValue": "3.52",
            "obsSubType": "NUMERICAL",
            "outMedian": "2.24",
            "outCount": 1,
            "keyArr": [
                "LITB"
            ],
            "lb": 1.008,
            "ub": 3.5008,
            "confidence": 99,
            "owlRank": 0,
            "linkId": "NYSE~|LITB~|2018-01-08",
            "linkIdArr": [
                "2018-01-08",
                "LITB",
                "NYSE"
            ],
            "assignmentId": {
                "id": 29876,
                "uuid": "771b2122-b8fd-44b2-97ff-fec0ff4df5a8"
            },
            "obsType": "OUTLIER_NUMERICAL"
        }
    ]
}

PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_DATA = [
    {
        "seqno": None,
        "updts": "2023-09-13T21:40:33.985+0000",
        "job_uuid": "175d82bf-ce91-4f5b-adfe-5d1de2a95557",
        "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-09-13T00:00:00.000+0000",
        "id": 830,
        "key_column": "SYMBOL",
        "key_value": "RENN",
        "value_column": "CLOSE",
        "value": "18.32",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "10.44",
        "lb": 4.526999999999995,
        "ub": 17.799000000000007,
        "confidence": 97,
        "cnt": 1,
        "link_id": "NYSE~|RENN~|2018-01-03",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": None,
        "updts": "2023-09-13T21:40:33.573+0000",
        "job_uuid": "175d82bf-ce91-4f5b-adfe-5d1de2a95557",
        "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-09-13T00:00:00.000+0000",
        "id": 830,
        "key_column": "SYMBOL",
        "key_value": "IDT",
        "value_column": "LOW",
        "value": "15.58",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "10.63",
        "lb": 6.9094999999999995,
        "ub": 15.309999999999999,
        "confidence": 98,
        "cnt": 1,
        "link_id": "NYSE~|IDT~|2017-12-04",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": None,
        "updts": "2023-09-13T21:40:33.573+0000",
        "job_uuid": "175d82bf-ce91-4f5b-adfe-5d1de2a95557",
        "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-09-13T00:00:00.000+0000",
        "id": 830,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.52",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815",
        "lb": 40.17974999999999,
        "ub": 83.45025000000001,
        "confidence": 99,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-16",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": None,
        "updts": "2023-09-13T21:40:33.573+0000",
        "job_uuid": "175d82bf-ce91-4f5b-adfe-5d1de2a95557",
        "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-09-13T00:00:00.000+0000",
        "id": 830,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.51",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815",
        "lb": 40.17974999999999,
        "ub": 83.45025000000001,
        "confidence": 99,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-12",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": None,
        "updts": "2023-09-13T21:40:33.573+0000",
        "job_uuid": "175d82bf-ce91-4f5b-adfe-5d1de2a95557",
        "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-09-13T00:00:00.000+0000",
        "id": 830,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.51",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815",
        "lb": 40.17974999999999,
        "ub": 83.45025000000001,
        "confidence": 99,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-15",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": None,
        "updts": "2023-09-13T21:40:33.573+0000",
        "job_uuid": "175d82bf-ce91-4f5b-adfe-5d1de2a95557",
        "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-09-13T00:00:00.000+0000",
        "id": 830,
        "key_column": "SYMBOL",
        "key_value": "DST",
        "value_column": "LOW",
        "value": "83.5",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "61.815",
        "lb": 40.17974999999999,
        "ub": 83.45025000000001,
        "confidence": 99,
        "cnt": 1,
        "link_id": "NYSE~|DST~|2018-01-11",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": None,
        "updts": "2023-09-13T21:40:29.432+0000",
        "job_uuid": "175d82bf-ce91-4f5b-adfe-5d1de2a95557",
        "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-09-13T00:00:00.000+0000",
        "id": 830,
        "key_column": "SYMBOL",
        "key_value": "YGE",
        "value_column": "HIGH",
        "value": "2.83",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "1.91",
        "lb": 1.0909999999999997,
        "ub": 2.7630000000000003,
        "confidence": 97,
        "cnt": 1,
        "link_id": "NYSE~|YGE~|2018-01-05",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": None,
        "updts": "2023-09-13T21:40:29.432+0000",
        "job_uuid": "175d82bf-ce91-4f5b-adfe-5d1de2a95557",
        "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-09-13T00:00:00.000+0000",
        "id": 830,
        "key_column": "SYMBOL",
        "key_value": "DDE",
        "value_column": "HIGH",
        "value": "1.79",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "1.04",
        "lb": 0.5549999999999999,
        "ub": 1.7630000000000001,
        "confidence": 98,
        "cnt": 1,
        "link_id": "NYSE~|DDE~|2018-01-12",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": None,
        "updts": "2023-09-13T21:40:29.432+0000",
        "job_uuid": "175d82bf-ce91-4f5b-adfe-5d1de2a95557",
        "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-09-13T00:00:00.000+0000",
        "id": 830,
        "key_column": "SYMBOL",
        "key_value": "LITB",
        "value_column": "HIGH",
        "value": "3.52",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "2.24",
        "lb": 1.008,
        "ub": 3.5008,
        "confidence": 99,
        "cnt": 1,
        "link_id": "NYSE~|LITB~|2018-01-08",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    },
    {
        "seqno": None,
        "updts": "2023-09-13T21:40:29.425+0000",
        "job_uuid": "175d82bf-ce91-4f5b-adfe-5d1de2a95557",
        "dataset": PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_DATASET,
        "run_id": "2023-09-13T00:00:00.000+0000",
        "id": 830,
        "key_column": "SYMBOL",
        "key_value": "LITB",
        "value_column": "OPEN",
        "value": "3.52",
        "date_value": None,
        "type": "NUMERICAL",
        "median": "2.005",
        "lb": 0.8652499999999996,
        "ub": 3.4472500000000004,
        "confidence": 97,
        "cnt": 1,
        "link_id": "NYSE~|LITB~|2018-01-08",
        "is_outlier": True,
        "is_historical": False,
        "is_topn": False,
        "is_botn": False,
        "source_date": None,
        "frequency": None,
        "percentile": None
    }
]

PD_DBRKS_OUTLIERS_NUM_KEY_NODATE_NYSE_ARCHIVE_BREAKS_EXPECTED_QUERY_RESULT = [
    {
        "id": 830,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-11",
        "OPEN": 84.14,
        "HIGH": 84.48,
        "LOW": 83.5,
        "CLOSE": 83.92,
        "VOLUME": 10154600,
        "PART_DATE_STR": "2018-01-11"
    },
    {
        "id": 830,
        "value_column": "HIGH",
        "EXCH": "NYSE",
        "SYMBOL": "DDE",
        "TRADE_DATE": "2018-01-12",
        "OPEN": 1.0,
        "HIGH": 1.79,
        "LOW": 1.0,
        "CLOSE": 1.11,
        "VOLUME": 2476400,
        "PART_DATE_STR": "2018-01-12"
    },
    {
        "id": 830,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-12",
        "OPEN": 83.95,
        "HIGH": 84.03,
        "LOW": 83.51,
        "CLOSE": 83.51,
        "VOLUME": 3083400,
        "PART_DATE_STR": "2018-01-12"
    },
    {
        "id": 830,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-15",
        "OPEN": 83.51,
        "HIGH": 83.51,
        "LOW": 83.51,
        "CLOSE": 83.51,
        "VOLUME": 0,
        "PART_DATE_STR": "2018-01-15"
    },
    {
        "id": 830,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "DST",
        "TRADE_DATE": "2018-01-16",
        "OPEN": 83.55,
        "HIGH": 83.75,
        "LOW": 83.52,
        "CLOSE": 83.63,
        "VOLUME": 2238800,
        "PART_DATE_STR": "2018-01-16"
    },
    {
        "id": 830,
        "value_column": "LOW",
        "EXCH": "NYSE",
        "SYMBOL": "IDT",
        "TRADE_DATE": "2017-12-04",
        "OPEN": 16.08,
        "HIGH": 16.48,
        "LOW": 15.58,
        "CLOSE": 15.63,
        "VOLUME": 175500,
        "PART_DATE_STR": "2017-12-04"
    },
    {
        "id": 830,
        "value_column": "CLOSE",
        "EXCH": "NYSE",
        "SYMBOL": "RENN",
        "TRADE_DATE": "2018-01-03",
        "OPEN": 13.39,
        "HIGH": 18.7,
        "LOW": 13.39,
        "CLOSE": 18.32,
        "VOLUME": 10462000,
        "PART_DATE_STR": "2018-01-03"
    },
    {
        "id": 830,
        "value_column": "HIGH",
        "EXCH": "NYSE",
        "SYMBOL": "YGE",
        "TRADE_DATE": "2018-01-05",
        "OPEN": 1.7,
        "HIGH": 2.83,
        "LOW": 1.682,
        "CLOSE": 2.115,
        "VOLUME": 6047400,
        "PART_DATE_STR": "2018-01-05"
    },
    {
        "id": 830,
        "value_column": "OPEN",
        "EXCH": "NYSE",
        "SYMBOL": "LITB",
        "TRADE_DATE": "2018-01-08",
        "OPEN": 3.52,
        "HIGH": 3.52,
        "LOW": 2.695,
        "CLOSE": 2.81,
        "VOLUME": 4890200,
        "PART_DATE_STR": "2018-01-08"
    },
    {
        "id": 830,
        "value_column": "HIGH",
        "EXCH": "NYSE",
        "SYMBOL": "LITB",
        "TRADE_DATE": "2018-01-08",
        "OPEN": 3.52,
        "HIGH": 3.52,
        "LOW": 2.695,
        "CLOSE": 2.81,
        "VOLUME": 4890200,
        "PART_DATE_STR": "2018-01-08"
    }
]
